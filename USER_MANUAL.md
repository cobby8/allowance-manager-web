# 정산 자동화 시스템 사용 매뉴얼

이 매뉴얼은 **정산 자동화 시스템**을 처음 사용하는 분들을 위한 가이드입니다.
구글 시트에 있는 직원 정보와 근무 내역을 자동으로 매칭하여 지급명세서와 증빙자료 PDF를 생성할 수 있습니다.

---

## 📋 사전 준비

시스템을 사용하기 전에 다음 사항을 확인하세요:

1. **구글 시트 준비**
   - 직원 기본 정보 시트 (이름, 주민등록번호, 연락처, 은행 정보 등)
   - 근무 내역 시트 (날짜, 이름, 지급액 등)

2. **시트 공유 설정**
   - 각 구글 시트의 **공유 설정**을 "링크가 있는 모든 사용자"로 변경
   - 권한은 "뷰어"로 설정

3. **시트 ID 확인**
   - 구글 시트 URL에서 `/d/`와 `/edit` 사이의 문자열이 시트 ID입니다
   - 예: `https://docs.google.com/spreadsheets/d/`**`1Vzo1a5jwx1Mx0w41fOEJHy-bq2KPj6pLU7ySUbGw29E`**`/edit`

---

## 🚀 사용 방법

### 1단계: 초기 화면

웹사이트에 접속하면 다음과 같은 초기 화면이 나타납니다.

![초기 화면](file:///C:/Users/cobby/.gemini/antigravity/brain/41113a6f-d839-40ba-a015-c3824157f959/initial_landing_page_1764526756117.png)

- **"베이스 데이터 시트 ID"** 입력란이 표시됩니다
- 여기에 직원 기본 정보가 담긴 구글 시트 ID를 입력합니다

---

### 2단계: 베이스 데이터 불러오기

![베이스 데이터 입력](file:///C:/Users/cobby/.gemini/antigravity/brain/41113a6f-d839-40ba-a015-c3824157f959/base_sheet_input_1764526764936.png)

1. **시트 ID 입력**: 직원 정보 시트의 ID를 입력란에 붙여넣습니다
2. **불러오기 버튼 클릭**: "베이스 데이터 불러오기" 버튼을 클릭합니다
3. 데이터 로딩이 시작되며, 잠시 기다리면 직원 정보가 표시됩니다

---

### 3단계: 근무 내역 연결 (선택)

![베이스 데이터 로드 완료](file:///C:/Users/cobby/.gemini/antigravity/brain/41113a6f-d839-40ba-a015-c3824157f959/base_data_loaded_1764526803488.png)

베이스 데이터가 로드되면:
- 직원 목록이 테이블 형태로 표시됩니다
- **"2단계: 근무 내역 연결"** 섹션이 나타납니다

근무 내역을 연결하려면:
1. **근무 내역 시트 ID** 입력란에 시트 ID를 붙여넣습니다
2. **"근무 내역 불러오기"** 버튼을 클릭합니다

> **참고**: 근무 내역 연결은 선택 사항입니다. 증빙자료만 필요한 경우 이 단계를 건너뛸 수 있습니다.

---

### 4단계: 정산 데이터 확인 및 PDF 다운로드

![최종 데이터 그리드](file:///C:/Users/cobby/.gemini/antigravity/brain/41113a6f-d839-40ba-a015-c3824157f959/final_data_grid_1764526857813.png)

근무 내역까지 로드되면:
- **정산 데이터**가 테이블에 표시됩니다
- 각 직원의 매칭 상태가 표시됩니다:
  - ✅ **매칭됨**: 직원 정보와 근무 내역이 정확히 일치
  - ⚠️ **부분 매칭**: 일부 정보만 일치 (확인 필요)
  - ❌ **매칭 안됨**: 근무 내역을 찾을 수 없음

#### PDF 다운로드 옵션

1. **개별 다운로드**
   - 각 직원 행의 오른쪽에 있는 버튼을 클릭
   - **"지급명세서"**: 급여 내역이 포함된 PDF
   - **"증빙자료"**: 신분증, 통장사본, 자격증 이미지가 포함된 PDF

2. **일괄 다운로드**
   - 테이블 상단의 버튼을 클릭
   - **"전체 명세서 다운로드"**: 모든 직원의 지급명세서를 하나의 PDF로 생성
   - **"전체 증빙자료 다운로드"**: 모든 직원의 증빙자료를 하나의 PDF로 생성

---

## ❓ 자주 묻는 질문

### Q1. 시트를 불러올 수 없다는 오류가 나타납니다
**A**: 구글 시트의 공유 설정을 확인하세요. "링크가 있는 모든 사용자"가 볼 수 있도록 설정되어 있어야 합니다.

### Q2. 매칭이 제대로 되지 않습니다
**A**: 다음 사항을 확인하세요:
- 직원 이름이 두 시트에서 정확히 일치하는지
- 주민등록번호 또는 연락처가 정확한지
- 띄어쓰기나 특수문자가 다르지 않은지

### Q3. PDF에 한글이 깨져 보입니다
**A**: 이 문제는 이미 해결되었습니다. 최신 버전에서는 한글이 정상적으로 표시됩니다.

### Q4. 데이터를 초기화하고 싶습니다
**A**: 화면 오른쪽 상단의 **"전체 초기화"** 버튼을 클릭하면 모든 데이터가 삭제되고 처음 화면으로 돌아갑니다.

---

## 📞 문의 및 지원

시스템 사용 중 문제가 발생하거나 궁금한 점이 있으시면 관리자에게 문의하세요.

**배포 URL**: https://allowance-manager-web.vercel.app
