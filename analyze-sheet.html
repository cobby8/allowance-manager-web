<!DOCTYPE html>
<html>
<head>
    <title>Sheet Analyzer</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Analyzing Sheet...</h1>
    <pre id="output"></pre>
    <script>
        const sheetId = '10ePPpdm9h6Gqe91HefJr2TMYE11dNstrZtICZRXLTuk';
        const url = `https://docs.google.com/spreadsheets/d/${sheetId}/export?format=xlsx`;
        
        fetch(url)
            .then(r => r.arrayBuffer())
            .then(buffer => {
                const workbook = XLSX.read(buffer);
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const data = XLSX.utils.sheet_to_json(firstSheet);
                
                const output = document.getElementById('output');
                output.textContent = JSON.stringify({
                    sheetName: workbook.SheetNames[0],
                    totalRows: data.length,
                    headers: Object.keys(data[0] || {}),
                    sampleData: data.slice(0, 5)
                }, null, 2);
            })
            .catch(err => {
                document.getElementById('output').textContent = 'Error: ' + err.message;
            });
    </script>
</body>
</html>
